<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>登陆</title>
		<link href="css/style.css" rel="stylesheet" type="text/css"/>
		<link href="css/login.css" rel="stylesheet" type="text/css"/>

	</head>
	<body>
		<header>
			<h1 class="l"><img src="img/logo.png"></h1>
			TCL账号登录
		</header>
		<div id="center">
			<form action="loginCheck.php" method="post">
			<div class="loginBox">
				<div class="boxheader">
					<span class="l">推荐第三方登录</span>
					<a href="#" class="r"></a>
					<a href="#" class="r"></a>
					<a href="#" class="r"></a>
				</div>
				<p>账号密码登录</p>
				<div class="text">
					<span class="bg"></span>
					<input name="userId" class="login_tel" type="text" placeholder="手机号/邮箱/用户名"/>
					<span class="tishi"></span>
				</div>
				<div class="password">
					<span class="bg"></span>
					<input name="userPass" class="login_pass" type="password" placeholder="登录密码"/>
					<span class="tishi"></span>
				</div>
				<button class="loginBtn">登录</button>
				<p class="method">
					<a href="#">短信验证登陆</a>
					<a href="#">注册TCL账号</a>
					<a href="#">找回密码</a>
				</p>
			</div>
			</form>
		</div>
		<footer>
			<p>
				<a href="#">关于TCL</a>
				<a href="#">社会责任</a>
				<a href="#">投资者关系</a>
				<a href="#">新闻中心</a>
				<a href="#">经销商之家</a>
			</p>
			<p> 
			©2010-2016 TCL CORPORATION All Rights Reserved. <a href="#">使用条款</a>  TCL集团股份有限公司版权所有 粤ICP备05040863号
			</p>
		</footer>
	</body>
</html>
<script type="text/javascript">

function $(str){
	if(str.charAt(0)=="#"){
		return document.getElementById(str.substring(1));
	}else if(str.charAt(0)=="."){
		return document.getElementsByClassName(str.substring(1));
	}else{
		return document.getElementsByTagName(str);
	}
}
window.onload = function(){
	$("#btnReg").onclick = function(){
		//1.创建对象
		let xhr = new XMLHttpRequest();
		//2.设置请求参数
		xhr.open("post","regSave.php",true);
		//设置回调函数
		xhr.onreadystatechange = function(){
			if(xhr.readyState ==4 && xhr.status == 200){
				//接收响应
		let str = xhr.responseText;
		if(str == "1"){
			alert("注册成功！");
			location.href = "index.html";
		}else if(str == "-1"){
			$(".tishi").style.display = "block";
			$(".tishi").innerHTML = "注册失败，用户名已存在";	
		}else{
			$(".tishi").style.display = "block";
			$(".tishi").innerHTML = "服务器出错";
		}
	}
			}
			xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

				//发送请求			
				let str = "username=" + $("#username").value + "&userpass=" + $("#userpass").value;
				xhr.send(str);		
	}
	$("#username").onblur = function(){
		//创建对象
		let xhr = new XMLHttpRequest();
		//2.设置请求参数
		xhr.open("get","checkuserdemo.php?username="+ this.value,true);
		//3.设置回调函数
		xhr.onreadystatechange = function(){
			if(xhr.readyState == 4 && xhr.status == 200){
				//5.接收响应
				let str = xhr.responseText;
				if(str == "1"){
					$(".tishi").innerHTML = "恭喜你，该用户没有人用，赶紧注册吧";
				}else{
					$(".tishi").innerHTML = "亲，不好意思，用户被别人用了，请重新思考";
				}
			}
		}
		//4.发送请求
		xhr.send();
	}
}

</script>